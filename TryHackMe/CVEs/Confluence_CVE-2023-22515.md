# Confluence CVEâ€‘2023â€‘22515

ðŸ§  Overview
Name: Confluence Broken Access Control / Privilege Escalation (CVEâ€‘2023â€‘22515)

Vulnerability: Broken access control allowing unauthenticated remote creation of administrator accounts in Atlassian Confluence Server and Data Center

Type: Remote unauthorized administrator creation â†’ broken access control / privilege escalation

Impact: Full administrative control of Confluence instanceâ€”compromise of confidentiality, integrity, availability

Affected Systems: Confluence Server & Data Center, versions 8.0.0 through 8.5.1; Atlassian Cloud (hosted at atlassian.net) and preâ€‘8.0 versions not affected 


A zeroâ€‘day vulnerability (initially classified as privilege escalation, later redefined as broken access control) allows an unauthenticated attacker to create an administrator account via Confluenceâ€™s setup endpoints 
Atlassian confirmed active exploitation in the wild and rated it critical with a CVSS score of 10 

Task 2: Exploitation Mechanics
Focus: How the exploit progresses through Confluence's setup endpoints.

The attacker sends a request to /server-info.action to reset the setupComplete flag,
 e.g.:

...?bootstrapStatusProvider.applicationConfig.setupComplete=false

With setup mode enabled, accessing /setup/setupadministrator-start.action with a header Xâ€‘Atlassianâ€‘Token: noâ€‘check bypasses normal restrictions and presents a form to create a new admin account 

Finally, the attacker completes the setup via /setup/finishsetup.action and logs in with the newly created admin credentials 
Senthorus Blog

Task 3: Detection & Indicators of Compromise
Focus: Identify signs that an instance was exploited.

Check for:

Unexpected members in the confluence-administrators group
Newly created user accounts
Logs showing requests to /setup/*.action endpoints
Exception messages containing /setup/setupadministrator.action in atlassian-confluence-security.log 

Task 4: Mitigation & Remediation
Focus: Fix the vulnerability and respond to potential compromise.

Permanent Fix:
Upgrade Confluence to 8.3.3 or later, 8.4.3 or later, or 8.5.2 (LTS) or later 

Temporary Mitigation (if immediate upgrade not possible):

Restrict external network access to Confluence instances.
Block /setup/* endpoints either via network layer or by modifying WEB-INF/web.xml:

<security-constraint>
  <web-resource-collection>
    <url-pattern>/setup/*</url-pattern>
    <http-method-omission>*</http-method-omission>
  </web-resource-collection>
  <auth-constraint />
</security-constraint>

Then restart Confluence 


Proactive Response:

Conduct threat detection: review logs, audit user accounts and security groups.
If compromise is confirmed, assume full accessâ€”respond as per security incident plan and contact Atlassian support 


## Summary

### Overview: 
CVEâ€‘2023â€‘22515 is a critical broken access control vulnerability allowing unauthenticated remote attackers to create admin accounts on Confluence Server/Data Center (versions 8.0.0â€“8.5.1).
### Exploit Flow: 
Trigger setup reset â†’ access setup endpoint with token header â†’ create admin â†’ finish setup.
### Detection: 
Monitor setup-related endpoints, logs, and admin group membership.
### Mitigation: 
Upgrade to patched versions immediately. If unpatched, block setup endpoints and restrict access; investigate for compromise.