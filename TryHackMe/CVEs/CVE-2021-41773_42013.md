# CVE-2021-41773

## Overview

**CVE-2021-41773** is a vulnerability found in **Apache HTTP Server** versions **2.4.49** and **2.4.50**. The issue is an **Improper Path Traversal** vulnerability that allows an attacker to **access files outside of the document root** through a crafted URL. This flaw can potentially lead to **Remote Code Execution (RCE)** in certain conditions if combined with other vulnerabilities.

This vulnerability impacts **mod_cgi** and **mod_cgid** in Apache HTTP Server. 

### Affected Versions:
- Apache HTTP Server 2.4.49
- Apache HTTP Server 2.4.50

### Severity:
- **CVSS Score**: 7.5 (High)

## Exploit Scenario

An attacker can exploit this vulnerability by sending a specially crafted request to the server. The server would incorrectly process path traversal characters like `../`, which allows access to files outside the root directory. This can lead to exposure of sensitive files such as:

- `/etc/passwd`
- `/etc/shadow`
- Web server configuration files

In the worst case, an attacker could gain remote code execution on the server.

## Technical Details

### Path Traversal Attack:

The attacker can use **`../`** sequences in the URL path to navigate outside the allowed document root directory. When the server processes the request, it might allow access to restricted files, depending on the configuration of the Apache server.

### Conditions for Exploitation:

- The attacker must have access to send HTTP requests to the vulnerable server.
- The server must be configured to allow CGI scripts and may also allow directory traversal.
- Certain configurations and file permissions must exist on the server for an exploit to succeed (e.g., sensitive files being accessible via HTTP).

## Mitigation & Patches

### Updates Available:
- **Apache HTTP Server 2.4.51** includes a fix for this vulnerability.

### Recommendations:
- Upgrade Apache HTTP Server to **version 2.4.51** or higher.
- If upgrading is not possible, temporarily disable **mod_cgi** or **mod_cgid** until a patch is applied.
- Restrict file access using `.htaccess` or server configuration to prevent traversal to sensitive files.

### Workaround:
- Block path traversal attacks using web application firewalls (WAF) or by carefully configuring the web server to reject suspicious paths.

## Exploiting CVE-2021-41773

### Steps to Exploit:
1. **Identify the vulnerable server**: Use tools like `nmap` to check for the presence of Apache HTTP Server.
2. **Craft a malicious request**: Use a path traversal string to attempt access to sensitive files.
3. **Check server response**: If the server is vulnerable, it will return the contents of the requested file.

### Tools for Exploitation:
- **Burp Suite**: Intercept and modify requests to test path traversal.
- **cURL**: Use `curl` to send crafted HTTP requests manually.
```bash
curl -X GET "http://vulnerable-website.com/../../../../etc/passwd"

### Defense Mechanisms
Patch the Apache server: The best way to mitigate this vulnerability is to update Apache to version 2.4.51 or later.
Limit permissions: Restrict access to sensitive files using the Apache server configuration and access control lists (ACLs).
Use a Web Application Firewall (WAF): Configure a WAF to block path traversal attempts.